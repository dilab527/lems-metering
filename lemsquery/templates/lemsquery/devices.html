{% extends "base.html" %}

{% block content %}

<form id="download" method="GET">
<table class="table table-hover">
    <thead>
        <tr>
            <th scope="col">시리얼번호</th>
            <th scope="col">Logical ID</th>
            <th scope="col">장비이름</th>
            <th scope="col">실제/가상</th>
            <th scope="col"></th>
        </tr>
    </thead>
    <tbody>            
    {% for device in devices %}
        <tr>
            <th scope="row">
                {{ device.serial_id }}
            </th>
            <th scope="row">
                {{ device.logical_id }}
            </th>
            <td>
                {{ device.name }}
            </td>
            <td>
                {{ device.virtual_type }}
            </td>
            <td>
                {% if device.serial_id %}
                <p class="mb-0">
                    <a id="button" class="btn btn-sm btn-block btn-outline-primary" onclick="onClick('{{ device.logical_id }}')">
                        전력값 다운로드
                    </a>
                </p>
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
    <div class="row">
        <label class="col-sm-2 col-md-1 col-form-label" 
            for="period">
            주기
        </label>
        <div class="col">
            <select class="form-control" id="period" name="period">
                <option>no</option>
                <option>1m</option>
                <option>5m</option>
                <option>15m</option>
                <option>1h</option>
                <option>1d</option>
                <option>1w</option>
                <option>1mo</option>
                <option>1y</option>
            </select>
        </div>
        <label for="start" class="col-sm-2 col-md-1 col-form-label">시작</label>
        <div class="col">
            <input class="form-control" id="start" name="start"/>
        </div>
        <label for="end" class="col-sm-2 col-md-1 col-form-label">종료</label>
        <div class="col">
            <input class="form-control" id="end" name="end"/>
        </div>
    </div>
</form>
{% endblock %}

{% block script %}
$('#start').datepicker({
    uiLibrary: 'bootstrap4'
});
$('#end').datepicker({
    uiLibrary: 'bootstrap4'
});
 
function onClick(logical_id) {
    $('#download').attr('action', '/devices/{{site_id}}/download/' + logical_id);
    $('#download').submit();
}
{% endblock %}